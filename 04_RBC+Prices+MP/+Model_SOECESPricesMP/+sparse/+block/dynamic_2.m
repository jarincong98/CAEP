function [y, T, residual, g1] = dynamic_2(y, x, params, steady_state, sparse_rowval, sparse_colval, sparse_colptr, T)
residual=NaN(21, 1);
  y(55)=(y(54)*y(48)/params(4))^(1/params(5));
  y(69)=y(59)*y(49);
  y(70)=y(69)*4;
  T(5)=params(10)*(y(53)/y(49))^params(8);
  T(6)=y(84)^(params(8)-1);
  y(60)=y(47)*T(5)*T(6);
  T(7)=(1-params(10))*(y(53)/y(50))^params(8);
  y(61)=T(6)*y(47)*T(7);
  T(8)=y(85)^(params(8)-1);
  T(9)=(1-params(11))*(y(56)/y(50))^params(9);
  y(63)=T(8)*y(52)*T(9);
  y(76)=y(72)*(y(50)-y(51)*params(22))-y(72)*y(50)*y(74);
  y(66)=y(50)*y(72);
  y(64)=(y(51)*y(81)/y(49))^params(12)*y(86);
  y(65)=y(49)*y(64);
  y(67)=y(65)-y(66);
  T(10)=1/y(82)*(y(57)/params(7))^params(7);
  T(11)=(y(48)/(1-params(7)))^(1-params(7));
  residual(1)=(y(78))-(T(10)*T(11));
  residual(2)=(y(77))-(y(78));
  residual(3)=(y(48))-(y(59)*(1-params(7))*y(77)/y(55));
  residual(4)=(y(73))-(params(19)/2*(y(49)/y(4)-1)^2);
  residual(5)=(y(59))-(y(73)+y(60)+y(62)+y(64));
  T(12)=params(11)*(y(56)/y(49))^params(9);
  residual(6)=(y(62))-(y(52)*T(12)*T(8));
  residual(7)=(y(74))-(params(20)/2*(y(50)/y(5)-1)^2);
  T(13)=exp(params(29)*(y(51)*y(81)*y(68)/y(70)-params(13)));
  residual(8)=(y(58))-(params(31)+T(13)-1);
  residual(9)=(y(76)+y(67))-(y(51)*y(81)*y(68)+y(81)*y(51)*(-(1+y(13)))*y(23));
  residual(10)=(y(87))-(params(35)*y(42)+(1-params(35))*params(32)+params(37)*(y(53)/params(34)-1)+params(36)*(y(69)/params(33)-1)+x(7));
  T(14)=(1/y(84))^(1-params(8));
  residual(11)=(y(53)^(1-params(8)))-(T(14)*(params(10)*y(49)^(1-params(8))+(1-params(10))*y(50)^(1-params(8))));
  T(15)=params(11)*y(49)^(1-params(9))+(1-params(11))*y(50)^(1-params(9));
  residual(12)=(y(56))-(1/y(85)*T(15)^(1/(1-params(9))));
  residual(13)=(y(52))-(y(46)-(1-params(2))*y(1)+params(6)/2*(y(46)-y(1))^2);
  residual(14)=(y(54)*y(56)*(1+params(6)*(y(46)-y(1))))-(params(3)*y(99)*y(101)*(1-params(2)+params(6)*(y(91)-y(46))+y(102)/y(101)));
  residual(15)=(y(54)*y(51)*y(81))-(params(3)*y(99)*y(96)*y(126)*(1+y(58)));
  residual(16)=(y(57))-(params(7)*y(77)*y(59)/y(1));
  T(16)=params(3)*(y(92)/y(47))^(-params(1));
  T(17)=(y(94)/y(49))^2;
  residual(17)=(y(78)*params(23)/y(49))-(params(23)-1+y(49)*params(19)*(y(49)/y(4)-1)/y(4)-params(19)*T(16)*(y(94)/y(49)-1)*T(17)*y(104)/y(59));
  T(18)=(y(95)/y(50))^2;
  residual(18)=(y(51)*y(83)*params(21)/y(50))-(params(21)-1+y(50)*params(20)*(y(50)/y(5)-1)/y(5)-T(16)*params(20)*(y(95)/y(50)-1)*T(18)*y(117)/y(72));
  residual(19)=(y(72))-(y(74)+y(61)+y(63));
  T(19)=y(47)^(-params(1));
  residual(20)=(y(54))-(T(19)/y(53));
  residual(21)=(y(53)*y(54))-(params(3)*y(99)*y(98)*(1+y(87)));
  T(20)=getPowerDeriv(y(92)/y(47),(-params(1)),1);
  T(21)=getPowerDeriv(y(54)*y(48)/params(4),1/params(5),1);
  T(22)=getPowerDeriv(y(51)*y(81)/y(49),params(12),1);
  T(23)=getPowerDeriv(y(53)/y(49),params(8),1);
  T(24)=getPowerDeriv(y(56)/y(49),params(9),1);
  T(25)=getPowerDeriv(T(15),1/(1-params(9)),1);
  T(26)=getPowerDeriv(y(53)/y(50),params(8),1);
  T(27)=getPowerDeriv(y(56)/y(50),params(9),1);
if nargout > 3
    g1_v = NaN(101, 1);
g1_v(1)=(-(y(23)*y(81)*(-y(51))));
g1_v(2)=(-(y(81)*y(51)*(-(1+y(13)))));
g1_v(3)=(-params(35));
g1_v(4)=(-(params(19)/2*(-y(49))/(y(4)*y(4))*2*(y(49)/y(4)-1)));
g1_v(5)=(-((y(4)*y(49)*params(19)*(-y(49))/(y(4)*y(4))-y(49)*params(19)*(y(49)/y(4)-1))/(y(4)*y(4))));
g1_v(6)=(-(params(20)/2*(-y(50))/(y(5)*y(5))*2*(y(50)/y(5)-1)));
g1_v(7)=(-((y(5)*y(50)*params(20)*(-y(50))/(y(5)*y(5))-y(50)*params(20)*(y(50)/y(5)-1))/(y(5)*y(5))));
g1_v(8)=(-(params(6)/2*(-(2*(y(46)-y(1))))-(1-params(2))));
g1_v(9)=y(54)*y(56)*(-params(6));
g1_v(10)=(-((-(params(7)*y(77)*y(59)))/(y(1)*y(1))));
g1_v(11)=(-(T(10)*1/(1-params(7))*getPowerDeriv(y(48)/(1-params(7)),1-params(7),1)));
g1_v(12)=1-(-(y(59)*(1-params(7))*y(77)*y(54)/params(4)*T(21)))/(y(55)*y(55));
g1_v(13)=1;
g1_v(14)=(-1);
g1_v(15)=params(23)/y(49);
g1_v(16)=1;
g1_v(17)=(-((1-params(7))*y(59)/y(55)));
g1_v(18)=(-(params(7)*y(59)/y(1)));
g1_v(19)=1;
g1_v(20)=(-1);
g1_v(21)=(-1);
g1_v(22)=1;
g1_v(23)=(-(T(12)*T(8)));
g1_v(24)=1;
g1_v(25)=(-(T(8)*T(9)));
g1_v(26)=1;
g1_v(27)=(-(y(50)*y(72)));
g1_v(28)=(-1);
g1_v(29)=1;
g1_v(30)=(-(params(3)*y(99)*y(96)*y(126)));
g1_v(31)=(-(T(13)*params(29)*y(51)*y(81)/y(70)));
g1_v(32)=(-(y(51)*y(81)));
g1_v(33)=1;
g1_v(34)=(-(params(3)*y(99)*y(98)));
g1_v(35)=(-(params(19)/2*2*(y(49)/y(4)-1)*1/y(4)));
g1_v(36)=(-(y(86)*(-(y(51)*y(81)))/(y(49)*y(49))*T(22)+T(6)*y(47)*params(10)*(-y(53))/(y(49)*y(49))*T(23)));
g1_v(37)=(-(T(8)*y(52)*params(11)*(-y(56))/(y(49)*y(49))*T(24)));
g1_v(38)=(-(T(13)*params(29)*(-(y(51)*y(81)*y(68)*y(59)*4))/(y(70)*y(70))));
g1_v(39)=y(64)+y(49)*y(86)*(-(y(51)*y(81)))/(y(49)*y(49))*T(22);
g1_v(40)=(-(params(36)*y(59)/params(33)));
g1_v(41)=(-(T(14)*params(10)*getPowerDeriv(y(49),1-params(8),1)));
g1_v(42)=(-(1/y(85)*params(11)*getPowerDeriv(y(49),1-params(9),1)*T(25)));
g1_v(43)=(-(y(78)*params(23)))/(y(49)*y(49))-((params(19)*(y(49)/y(4)-1)+y(49)*params(19)*1/y(4))/y(4)-y(104)*(T(17)*params(19)*T(16)*(-y(94))/(y(49)*y(49))+params(19)*T(16)*(y(94)/y(49)-1)*(-y(94))/(y(49)*y(49))*2*y(94)/y(49))/y(59));
g1_v(44)=(-(params(20)/2*2*(y(50)/y(5)-1)*1/y(5)));
g1_v(45)=y(72)-y(72)*y(74)-y(72);
g1_v(46)=(-(T(14)*(1-params(10))*getPowerDeriv(y(50),1-params(8),1)));
g1_v(47)=(-(1/y(85)*T(25)*(1-params(11))*getPowerDeriv(y(50),1-params(9),1)));
g1_v(48)=(-(y(51)*y(83)*params(21)))/(y(50)*y(50))-((params(20)*(y(50)/y(5)-1)+y(50)*params(20)*1/y(5))/y(5)-y(117)*(T(18)*T(16)*params(20)*(-y(95))/(y(50)*y(50))+T(16)*params(20)*(y(95)/y(50)-1)*(-y(95))/(y(50)*y(50))*2*y(95)/y(50))/y(72));
g1_v(49)=(-(T(6)*y(47)*(1-params(10))*(-y(53))/(y(50)*y(50))*T(26)+T(8)*y(52)*(1-params(11))*(-y(56))/(y(50)*y(50))*T(27)));
g1_v(50)=(-(1+params(6)/2*2*(y(46)-y(1))));
g1_v(51)=params(6)*y(54)*y(56)-params(3)*y(99)*y(101)*(-params(6));
g1_v(52)=(-(T(8)*y(52)*params(11)*T(24)*1/y(49)));
g1_v(53)=1;
g1_v(54)=y(54)*(1+params(6)*(y(46)-y(1)));
g1_v(55)=(-(T(8)*y(52)*(1-params(11))*T(27)*1/y(50)));
g1_v(56)=(-(y(86)*T(22)*y(81)/y(49)));
g1_v(57)=(-(T(13)*params(29)*y(81)*y(68)/y(70)));
g1_v(58)=y(72)*(-params(22))+y(49)*y(86)*T(22)*y(81)/y(49)-(y(81)*y(68)+y(23)*y(81)*(-(1+y(13))));
g1_v(59)=y(54)*y(81);
g1_v(60)=y(83)*params(21)/y(50);
g1_v(61)=(-(T(11)*1/y(82)*1/params(7)*getPowerDeriv(y(57)/params(7),params(7),1)));
g1_v(62)=1;
g1_v(63)=(-((1-params(7))*y(77)/y(55)));
g1_v(64)=1;
g1_v(65)=(-(T(13)*params(29)*(-(y(51)*y(81)*y(68)*y(49)*4))/(y(70)*y(70))));
g1_v(66)=(-(params(36)*y(49)/params(33)));
g1_v(67)=(-(params(7)*y(77)/y(1)));
g1_v(68)=(-(params(19)*T(16)*(y(94)/y(49)-1)*T(17)*y(104)))/(y(59)*y(59));
g1_v(69)=(-(T(5)*T(6)));
g1_v(70)=y(104)*T(17)*(y(94)/y(49)-1)*params(19)*params(3)*(-y(92))/(y(47)*y(47))*T(20)/y(59);
g1_v(71)=y(117)*T(18)*(y(95)/y(50)-1)*params(20)*params(3)*(-y(92))/(y(47)*y(47))*T(20)/y(72);
g1_v(72)=(-(T(6)*T(7)));
g1_v(73)=(-(getPowerDeriv(y(47),(-params(1)),1)/y(53)));
g1_v(74)=y(50)-y(51)*params(22)-y(50)*y(74)-y(50);
g1_v(75)=(-(T(16)*params(20)*(y(95)/y(50)-1)*T(18)*y(117)))/(y(72)*y(72));
g1_v(76)=1;
g1_v(77)=(-(T(6)*y(47)*params(10)*T(23)*1/y(49)));
g1_v(78)=(-(params(37)*1/params(34)));
g1_v(79)=getPowerDeriv(y(53),1-params(8),1);
g1_v(80)=(-(T(6)*y(47)*(1-params(10))*T(26)*1/y(50)));
g1_v(81)=(-((-T(19))/(y(53)*y(53))));
g1_v(82)=y(54);
g1_v(83)=(-((-(y(59)*(1-params(7))*y(77)*T(21)*y(48)/params(4)))/(y(55)*y(55))));
g1_v(84)=y(56)*(1+params(6)*(y(46)-y(1)));
g1_v(85)=y(51)*y(81);
g1_v(86)=1;
g1_v(87)=y(53);
g1_v(88)=y(104)*(T(17)*params(19)*T(16)*1/y(49)+params(19)*T(16)*(y(94)/y(49)-1)*2*y(94)/y(49)*1/y(49))/y(59);
g1_v(89)=y(117)*(T(18)*T(16)*params(20)*1/y(50)+T(16)*params(20)*(y(95)/y(50)-1)*2*y(95)/y(50)*1/y(50))/y(72);
g1_v(90)=(-(params(6)*params(3)*y(99)*y(101)));
g1_v(91)=(-(params(3)*y(99)*(1-params(2)+params(6)*(y(91)-y(46))+y(102)/y(101))+params(3)*y(99)*y(101)*(-y(102))/(y(101)*y(101))));
g1_v(92)=(-((1+y(58))*params(3)*y(99)*y(126)));
g1_v(93)=(-(params(3)*y(99)*y(101)*1/y(101)));
g1_v(94)=params(19)*T(16)*(y(94)/y(49)-1)*T(17)/y(59);
g1_v(95)=y(104)*T(17)*(y(94)/y(49)-1)*params(19)*params(3)*T(20)*1/y(47)/y(59);
g1_v(96)=y(117)*T(18)*(y(95)/y(50)-1)*params(20)*params(3)*T(20)*1/y(47)/y(72);
g1_v(97)=T(16)*params(20)*(y(95)/y(50)-1)*T(18)/y(72);
g1_v(98)=(-(params(3)*y(99)*(1+y(87))));
g1_v(99)=(-((1-params(2)+params(6)*(y(91)-y(46))+y(102)/y(101))*params(3)*y(101)));
g1_v(100)=(-((1+y(58))*y(126)*params(3)*y(96)));
g1_v(101)=(-((1+y(87))*params(3)*y(98)));
    if ~isoctave && matlab_ver_less_than('9.8')
        sparse_rowval = double(sparse_rowval);
        sparse_colval = double(sparse_colval);
    end
    g1 = sparse(sparse_rowval, sparse_colval, g1_v, 21, 63);
end
end
